---
title: "[COVID-19 Situation Report](https://unlikelyvolcano.com/covid-report.html)"
author: "[UnlikelyVolcano (David Azizi)](https://unlikelyvolcano.com)"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = FALSE, out.width = "100%")
confirmed <-
  read.csv(
    "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Confirmed.csv"
  )
deaths <-
  read.csv(
    "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Deaths.csv"
  )
recovered <-
  read.csv(
    "https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_19-covid-Recovered.csv"
  )
```

This report was last updated on `r Sys.Date()`. Data courtesy of [JHU CSSE](https://systems.jhu.edu/research/public-health/ncov/).

[United States report here.](https://unlikelyvolcano.com/covid-us.html)

<script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101237072);</script>
<script async src="//static.getclicky.com/js"></script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/101237072ns.gif" /></p></noscript>

## Global {.tabset}

```{r world}
world_confirmed <-
  data.frame(
    date = as.Date(names(confirmed), format = "X%m.%e.%y")[-(1:4)],
    cases = colSums(confirmed[, -(1:4)], na.rm = T)
  )

new_cases <-
  world_confirmed$cases[-1] - world_confirmed$cases[-nrow(world_confirmed)]
by_day <-
  world_confirmed$cases[-1] / world_confirmed$cases[-nrow(world_confirmed)]
growth_rate <- new_cases[-1] / new_cases[-length(new_cases)]
growth_data <- data.frame(
  date = world_confirmed$date[-(1:2)],
  cases = world_confirmed$cases[-(1:2)],
  change_cases = by_day[-1],
  new_cases = new_cases[-1],
  change_new = growth_rate
)
```

### Cumulative Cases
```{r world:total}
plot(
  world_confirmed,
  main = "Cumulative Cases of COVID-19",
  pch = 20,
  xlab = "Date",
  ylab = "Cases",
  type = "o"
)
```


```{r world:logged}
plot(
  world_confirmed$date,
  log(world_confirmed$cases),
  main = "Cumulative Cases of COVID-19, Logged",
  pch = 20,
  xlab = "Date",
  ylab = "log(Cases)"
)
lm2 <- lm(log(cases) ~ date, data = world_confirmed)
abline(lm2$coefficients[1], lm2$coefficients[2])
sm2 <- summary(lm2)
text(x = world_confirmed$date[nrow(world_confirmed) - 5],
     y = 2,
     labels = paste0("R^2 = ", round(sm2$r.squared, 3)))
```

### Growth Rate

```{r us:newcases}
plot(
  growth_data$date,
  growth_data$new_cases,
  main = "New Cases by Day",
  xlab = "Date",
  ylab = "New Cases",
  pch = 20,
  type = "o"
)
```

```{r us:growth}
plot(
  growth_data$date,
  growth_data$change_new,
  main = "Change in New Cases by Day",
  xlab = "Date",
  ylab = "∂ New Cases",
  pch = 20,
  type = "o"
)
```

### Table

```{r world:table}
out <- growth_data[(world_confirmed$date > "2020-02-29")[-(1:2)], ]
kable(out,
      col.names = c("Date", "Cases", "∂ Cases", "New Cases", "∂ New Cases"),
      row.names = F,
      digits = 3)
```

